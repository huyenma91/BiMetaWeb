{% extends "pages/base.html" %} {% load static %}
{% block title%}BiMeta System{% endblock %} {% block content %} 
{% include 'pages/header.html' %}
<div class="page-head" data-bg-image="{% static 'images/page-head-2.jpg' %}" id="system">
    <div class="container">
        <!-- <h2 class="page-title">System</h2>
        <small>The left column below is the place for dataset uploading and running Hadoop system and the right column for parameters explanation. </small> -->
    </div>
</div>

<div id="display_files" style="font-family: Helvetica, sans-serif;">
    <form>
        <p id="nodata">No data file in system's folder</p>
        <table id="neatdata" cellpadding="0" cellspacing="0" > 
        </table>
    </form>
</div>

<div class="container-fluid">
    <div class="row">
        <form method="post" enctype="multipart/form-data" data-bg-color="#edf2f4" style="padding: 2em;" class="col-md-6 col-sm-12">
            <div class="body_section2">
                <div class="area2">
                    <p class="body_section2_title bold">Input dataset file</p>
                </div>
                <div class="area2 row">
                    {% csrf_token %} {{ form.as_p }}
                    <div class="upload-file">
                        <label class="custom-file-upload">
                            <i class="fa fa-upload"></i><input type="file" name="file" id="file">
                            Upload New File
                        </label>
                        <button id="myButton" class="show-file-upload" type="button"><i class="fa-2x fa fa-file"></i></button>
                    </div>
                  
                    <span id="file-selected"></span>
    
    
                    <div id="progress-div" style="display:none">
                        <div class="progress">
                            <div class="progress-bar" id="progress-bar" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                        </div>
                    </div>
                    <p id="progress-text"></p>
                    <div class="button_area" id="stop-div" style="display:none">
                        <button class="stop_button bold" type="button" id="stop_button">Stop</button>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="body_section3">
                <div class="area3">
                    <p class="body_section3_title bold">Parameters</p>
                </div>
                <div class="area3_1 row">
                    <div class="col" style="display: flex;">
                        <p class="body_section3_title bold">K-mer size:</p>
                        <button id="button_kmer" class="show-info" type="button"><i class="fa fa-info"></i></button>
                    </div>
                    <input class="col" type="number" min="1" id="kmer">
                </div>
                <div class="area3_1 row">
                    <div class="col" style="display: flex;">
                        <p class="body_section3_title bold">Length of Q-mer:</p>
                        <button id="button_lofqmer" class="show-info" type="button"><i class="fa fa-info"></i></button>
                    </div>
                    <input class="col" type="number" min="1" id="lofqmer">
                </div>
                <div class="area3_1 row">
                    <div class="col" style="display: flex;">
                        <p class="body_section3_title bold">Number of share reads:</p>
                    <button id="button_sharereads" class="show-info" type="button"><i class="fa fa-info"></i></button>
                    </div>
                    <input class="col" type="number" min="1" id="sharereads">
                </div>
                <div class="area3_1 row">
                    <div class="col" style="display: flex;">
                        <p class="body_section3_title bold" >Maximum component size:</p>
                        <button id="button_maxcomp" class="show-info" type="button"><i class="fa fa-info"></i></button> 
                    </div>
                    <input class="col" type="number" min="1" id="maxcomp">
                </div>
            </div>
            <br><br>
            <div class="body_section4">
                <div class="area4">
                    <p class="body_section3_title bold">Output</p>
                </div>
                <div class="area4_1 row">
                    <p class="body_section4_title col bold">Export graph visualize:</p>
                    <select class="col" id="exGraph">
                    <option>Yes</option>
                    <option>No</option>
                </select>
                </div>
                <div class="area4_1 row">
                    <p class="body_section4_title col bold" min="1">Export cluster group files:</p>
                    <select class="col" id="exFile">
                    <option>Yes</option>
                    <option>No</option>
                </select>
                </div>
            </div>
            <br><br>
            <div class="button_area">
                <button class="submit_button bold" id="startButton" type="button" onclick="getValue(event)">Start</button>
                <button class="clear_button bold" id="clearButton" type="button" onclick="clearValue()">Clear</button>
            </div>
            <br>
            <center><div class="loader" id="loader" style="display: none;"></div></center>
        </form>
    
       
      
        <div class="col-md-6 col-sm-12">
            <div class="row" style="height: 10vh">
                <div id="display_output" class="box col-md-6 col-sm-6" style="font-family: Helvetica, sans-serif">
                    <h2 style="text-align: center;">Output files </h3>
                    <div id="outputData">
                    </div>
                </div>
                <div class="box col-md-6 col-sm-6" style="font-family: Helvetica, sans-serif">
                    <h2 style="text-align: center;">Overview info</h3>
                    <div id="overview">
                    </div>
                </div>
            </div>
            <div class="row" style="height: 60vh">
                <div  class="box col-md-12 col-sm-12">
                    <h2 style="text-align: center;">Node graph</h2>
                    <center><img src="{% static 'images/node_graph.jpeg' %}" style="width: 500px;height: 500px;" alt="node_graph"></center>
                    
                </div>
               
                <!-- <div class="box col-md-6 col-sm-6" style="font-family: Helvetica, sans-serif;">
                    <div>
                    </div>
                </div> -->
            </div>
            <div class="row" style="height: 30vh">
                <div  id="popupGraph" class="box col-md-6 col-sm-6 ">
                    <h2 style="text-align: center;">Major reads of species</h2>
                    <div id="chartdiv" class="chartdiv"></div>
                </div>
                <div class="box col-md-6 col-sm-6" style="font-family: Helvetica, sans-serif">
                    <div >
                    </div>
                </div>
            </div>
        </div>
        <div id="chart" style="display: none;">
            <!-- <div id="chartdiv"></div> -->

        </div>
        <div class="fullwidth-block" style="padding: 1.5em 0 0 0">
            <div id="info_kmer" class="boxed-icon">
                <img src="{% static 'images/kmer.png' %}" style="width: 50px;height: 50px;" alt="" class="icon">
                <h2 style="color: #8e9ca5;">K-mer size</h2>
                <p style="color: #8e9ca5;">Using for <b>extracting compositional features</b> of the read groups.<br> 
                    Instead of extracting the features from all reads of each group, we compute <br>
                    k-mer frequency distribution</b> of their <b>subgroups</b> which only consists<br>
                    of <b>non-overlapping reads</b>. k-mers are composed of nucleotides (i.e. A, T, G, and C).<br> 
                    Usually, the term k-mer refers to all of a sequence's subsequences of length <b>k</b>,<br>
                    such that the sequence AGAT would have four monomers (A, G, A, and T).
                </p>
            </div>

            <div id="info_lofqmer" class="boxed-icon">
                <img src="{% static 'images/qmer.png' %}" style="width: 60px;height: 60px;" alt="" class="icon">
                <h2 style="color: #8e9ca5;">Length of Q-mer</h2>
                <p style="color: #8e9ca5;">One of two parameters for creating overlap graph. Adjust the length number of shared q-mers.<br> 
                    Most of q-mer repeats in a metagenomic dataset are caused by overlaps of reads.<br>
                    Thus, there is a great probability that the reads sharing q-mers with each other<br> 
                    (with a sufficient value of q) are overlapping reads.</p>
            </div>

            <div id="info_sharereads" class="boxed-icon">
                <img src="{% static 'images/shareread.png' %}" style="width: 60px;height: 60px;" alt="" class="icon">
                <h2 style="color: #8e9ca5;">Number of shared reads</h2>
                <p style="color: #8e9ca5;">One of two parameters for creating overlap graph. Adjust the number of shared reads<br>
                    between reads to define overlap reads.</p>
            </div>

            <div id="info_maxcomp" class="boxed-icon">
                <img src="{% static 'images/maxcom.png' %}" style="width: 50px;height: 50px;" alt="" class="icon">
                <h2 style="color: #8e9ca5;">Maximum component size</h2>
                <p style="color: #8e9ca5;">Define the number of overlaped nodes in a group which allow a balance system.</p>
            </div>
        </div>
</div>

</div>
<script src="../../static/jsCode/jquery-1.11.1.min.js"></script>
<script src="../../static/jsCode/plugins.js"></script>
<script src="../../static/jsCode/app.js"></script>
<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
<script type="text/javascript" src="../../static/overview.js"></script>
<script type="text/javascript" src="../../static/barChart.js"></script>
<script type="text/javascript" src="../../static/main.js">
</script>
<script>
    const ref = document.getElementById('display_files');
    tippy('#myButton', {
    content: ref,
    trigger: 'click',
    interactive: 'true',
});

    const info_kmer = document.getElementById('info_kmer');
    tippy('#button_kmer', {
    content: info_kmer,
    trigger: 'click',
});
    const info_lofqmer = document.getElementById('info_lofqmer');
    tippy('#button_lofqmer', {
    content: info_lofqmer,
    trigger: 'click',
});
    const info_sharereads = document.getElementById('info_sharereads');
    tippy('#button_sharereads', {
    content: info_sharereads,
    trigger: 'click',
});
    const info_maxcomp = document.getElementById('info_maxcomp');
    tippy('#button_maxcomp', {
    content: info_maxcomp,
    trigger: 'click',
});
</script>

{% endblock %}